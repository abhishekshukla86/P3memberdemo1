{
	"name": "Member_Enrollment",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "MemberEnrollmentSRC",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "DelimitedText9",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "SurrogateKey1"
				},
				{
					"name": "Select1"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "Select2"
				},
				{
					"name": "Select3"
				},
				{
					"name": "Join1"
				}
			],
			"script": "source(output(\n\t\tMember_KEY as string,\n\t\tMEMBER_ID as string,\n\t\tClient_Member_ID as string,\n\t\tEnrollment_Contract_ID as string,\n\t\tEnrollment_Benefit_Plan_ID as string,\n\t\tSTART_DATE as string,\n\t\tEND_DATE as string,\n\t\tMEDICAL_BENEFIT as string,\n\t\tPAYER_CODE as string,\n\t\tPRODUCT_CODE as string,\n\t\tPCP_PROVIDERID as string,\n\t\tMENTALHEALTH_AMBULATORY as string,\n\t\tMENTALHEALTH_INPATIENT as string,\n\t\tMENTALHEALTH_DAYNIGHT as string,\n\t\tCHEMDEPEND_AMBULATORY as string,\n\t\tCHEMDEPEND_INPATIENT as string,\n\t\tCHEMDEPEND_DAYNIGHT as string,\n\t\tDRUG_BENEFIT as string,\n\t\tVISION_BENEFIT as string,\n\t\tDENTAL_BENEFIT as string,\n\t\tHospice_Indicator as string,\n\t\tDisease_Management_Program_Indicator as string,\n\t\tDisease_Management_Severity_Factor as string,\n\t\tGROUP_ID as string,\n\t\tOTHER_INSURANCE_FLAG as string,\n\t\tPRIMARY_INSURANCE_FLAG as string,\n\t\tPLANEMPLOYEEFLAG as string,\n\t\tMEDICARE_CONTRACT_NUMBER as string,\n\t\tAID_GROUP as string,\n\t\tCOBRA_FLAG as string,\n\t\tCOVERAGE_TIER as string,\n\t\tEMPLOYERCODE as string,\n\t\tEMPLOYERDESCRIPTION as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE1 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE2 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE3 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE4 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE5 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE6 as string,\n\t\tMEDICARE_PLANID_NUMBER as string,\n\t\tSNP_ENROLLEE_TYPE as string,\n\t\tPCP_START_DATE as string,\n\t\tPCP_END_DATE as string,\n\t\tClient_Member_Enrollment_ID as string,\n\t\tMember_Enrollment_Member_Alternate_Identifier_1 as string,\n\t\tMember_Enrollment_Alternate_Identifier_2 as string,\n\t\tMember_Enrollment_Alternate_Identifier_3 as string,\n\t\tMember_Enrollment_Alternate_Identifier_4 as string,\n\t\tMember_Enrollment_Alternate_Identifier_5 as string,\n\t\tMember_Enrollment_Alternate_Identifier_6 as string,\n\t\tMember_Enrollment_Alternate_Identifier_7 as string,\n\t\tMember_Enrollment_Alternate_Identifier_8 as string,\n\t\tBenefit_Code as string,\n\t\t{Member Enrollment QHP State} as string,\n\t\tESRD_Flag as string,\n\t\tLTI_Flag as string,\n\t\tIssuer_ID as string,\n\t\tMetal_Level as string,\n\t\tCost_Sharing_Reduction_Code as string,\n\t\tMSP_Flag as string,\n\t\tMarket_Coverage as string,\n\t\tEnrollment_Route as string,\n\t\tCSR_Eligibility_Flag as string,\n\t\tPlan_Marketing_Name as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource(output(\n\t\tMEMBER_ID as integer,\n\t\tFULL_NAME as string,\n\t\tFIRST_NAME as string,\n\t\tLAST_NAME as string,\n\t\tMIDDLE_NAME as string,\n\t\tSSN as integer,\n\t\tMember_Key as string,\n\t\tDOB as date,\n\t\tGENDER as string,\n\t\tMEDICARE_ID as long,\n\t\tMEDICAID_ID as long,\n\t\tSUBSCRIBER_ID as integer,\n\t\tMEMBERALTID1 as string,\n\t\tMEMBERALTID2 as string,\n\t\tMEMBERALTID3 as string,\n\t\tMEMBERALTID4 as string,\n\t\tMEMBERALTID5 as string,\n\t\tMEMBERALTID6 as string,\n\t\tRELATIONSHIP as boolean,\n\t\tADDRESS1 as string,\n\t\tADDRESS2 as string,\n\t\tCITY as string,\n\t\tSTATE as string,\n\t\tZIP as integer,\n\t\tCOUNTY as string,\n\t\tMember_Contact_Pref as string,\n\t\tLocation_Usage_Type_Code as string,\n\t\tLocation_Usage_Preference_Code as string,\n\t\tHOME_PHONE as string,\n\t\tMOBILE_PHONE as string,\n\t\tPhone_Usage_Type_Code as string,\n\t\tPhone_Usage_Preference_Code as string,\n\t\tEMAIL_ADDRESS as string,\n\t\tEmail_Usage_Type_Code as string,\n\t\tEmail_Usage_Preference_Code as string,\n\t\tMARITAL_STATUS as short,\n\t\tRACE as short,\n\t\tETHNICITY as short,\n\t\tEthnicity_Type as string,\n\t\tRBI_ETHNICITY as short,\n\t\tDeceased_Date as string,\n\t\tRACEETHNICITYSOURCE as string,\n\t\tLANGUAGESPOKEN as short,\n\t\tLANGUAGEWRITTEN as short,\n\t\tLANGUAGEOTHER as string,\n\t\tLANGUAGESPOKENSOURCE as string,\n\t\tLANGUAGEWRITTENSOURCE as string,\n\t\tLANGUAGEOTHERSOURCE as string,\n\t\tLanguge_Usage_Type_Code as string,\n\t\tLanguge_Usage_Preference_Code as string,\n\t\tALTERNATE_PHONE1 as string,\n\t\tALTERNATE_PHONE2 as string,\n\t\tALTERNATE_PHONE3 as string,\n\t\tALTERNATE_PHONE4 as string,\n\t\tALTERNATE_PHONE5 as string,\n\t\tAUTHORIZED_REP_A as string,\n\t\tAUTHORIZED_REP_A_PHONE_1 as string,\n\t\tAUTHORIZED_REP_A_PHONE_2 as string,\n\t\tAUTHORIZED_REP_B as string,\n\t\tAUTHORIZED_REP_B_PHONE_1 as string,\n\t\tAUTHORIZED_REP_B_PHONE_2 as string,\n\t\tOREC as string,\n\t\tECDS_Flag as string,\n\t\tEnrollee_Unique_ID as string,\n\t\tQHP_State as string,\n\t\tCitizenship_Status_Code as string,\n\t\tCountry_Flips_Code as string,\n\t\tWhite_Indirect_Estimate as string,\n\t\tBlack_Indirect_Estimate as string,\n\t\tAsian_Indirect_Estimate as string,\n\t\tAme_rIndian_Indirect_Estimate as string,\n\t\tOther_Indirect_Estimate as string,\n\t\tHispanic_Indirect_Estimate as string,\n\t\tClient_ID_Number as string,\n\t\tCMS_PlanID as string,\n\t\tClient_Member_ID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source2\nsource1 keyGenerate(output(Member_Enrollment_ID as long),\n\tstartAt: 1L) ~> SurrogateKey1\nsource2 select(mapColumn(\n\t\tMEMBER_ID,\n\t\tSSN,\n\t\tMember_Key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(Member_Key = (toString(MEMBER_ID) + toString(SSN)),\n\t\tMEMBER_ID = toString(MEMBER_ID)) ~> DerivedColumn1\nDerivedColumn1 select(mapColumn(\n\t\tMEMBER_ID,\n\t\tMember_Key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSurrogateKey1 select(mapColumn(\n\t\tMEMBER_ID,\n\t\tClient_Member_ID,\n\t\tEnrollment_Contract_ID,\n\t\tEnrollment_Benefit_Plan_ID,\n\t\tSTART_DATE,\n\t\tEND_DATE,\n\t\tMEDICAL_BENEFIT,\n\t\tPAYER_CODE,\n\t\tPRODUCT_CODE,\n\t\tPCP_PROVIDERID,\n\t\tMENTALHEALTH_AMBULATORY,\n\t\tMENTALHEALTH_INPATIENT,\n\t\tMENTALHEALTH_DAYNIGHT,\n\t\tCHEMDEPEND_AMBULATORY,\n\t\tCHEMDEPEND_INPATIENT,\n\t\tCHEMDEPEND_DAYNIGHT,\n\t\tDRUG_BENEFIT,\n\t\tVISION_BENEFIT,\n\t\tDENTAL_BENEFIT,\n\t\tHospice_Indicator,\n\t\tDisease_Management_Program_Indicator,\n\t\tDisease_Management_Severity_Factor,\n\t\tGROUP_ID,\n\t\tOTHER_INSURANCE_FLAG,\n\t\tPRIMARY_INSURANCE_FLAG,\n\t\tPLANEMPLOYEEFLAG,\n\t\tMEDICARE_CONTRACT_NUMBER,\n\t\tAID_GROUP,\n\t\tCOBRA_FLAG,\n\t\tCOVERAGE_TIER,\n\t\tEMPLOYERCODE,\n\t\tEMPLOYERDESCRIPTION,\n\t\tMEMBERENROLLMENTCUSTOMCODE1,\n\t\tMEMBERENROLLMENTCUSTOMCODE2,\n\t\tMEMBERENROLLMENTCUSTOMCODE3,\n\t\tMEMBERENROLLMENTCUSTOMCODE4,\n\t\tMEMBERENROLLMENTCUSTOMCODE5,\n\t\tMEMBERENROLLMENTCUSTOMCODE6,\n\t\tMEDICARE_PLANID_NUMBER,\n\t\tSNP_ENROLLEE_TYPE,\n\t\tPCP_START_DATE,\n\t\tPCP_END_DATE,\n\t\tClient_Member_Enrollment_ID,\n\t\tMember_Enrollment_Member_Alternate_Identifier_1,\n\t\tMember_Enrollment_Alternate_Identifier_2,\n\t\tMember_Enrollment_Alternate_Identifier_3,\n\t\tMember_Enrollment_Alternate_Identifier_4,\n\t\tMember_Enrollment_Alternate_Identifier_5,\n\t\tMember_Enrollment_Alternate_Identifier_6,\n\t\tMember_Enrollment_Alternate_Identifier_7,\n\t\tMember_Enrollment_Alternate_Identifier_8,\n\t\tBenefit_Code,\n\t\t{Member Enrollment QHP State},\n\t\tESRD_Flag,\n\t\tLTI_Flag,\n\t\tIssuer_ID,\n\t\tMetal_Level,\n\t\tCost_Sharing_Reduction_Code,\n\t\tMSP_Flag,\n\t\tMarket_Coverage,\n\t\tEnrollment_Route,\n\t\tCSR_Eligibility_Flag,\n\t\tPlan_Marketing_Name,\n\t\tMember_Enrollment_ID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nSelect3, Select2 join(Select3@MEMBER_ID == Select2@MEMBER_ID,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join1"
		}
	}
}