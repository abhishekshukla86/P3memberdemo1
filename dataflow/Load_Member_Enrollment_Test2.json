{
	"name": "Load_Member_Enrollment_Test2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Member_Enrollment_CSV",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlTable12",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Sink_Member_enrollment",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "SurrogateKey1"
				},
				{
					"name": "Lookup1"
				},
				{
					"name": "DerivedColumn2"
				}
			],
			"script": "source(output(\n\t\tMember_KEY as string,\n\t\tMEMBER_ID as integer,\n\t\tClient_Member_ID as string,\n\t\tEnrollment_Contract_ID as string,\n\t\tEnrollment_Benefit_Plan_ID as string,\n\t\tSTART_DATE as string,\n\t\tEND_DATE as date 'MM/dd/yyyy',\n\t\tMEDICAL_BENEFIT as string,\n\t\tPAYER_CODE as string,\n\t\tPRODUCT_CODE as string,\n\t\tPCP_PROVIDERID as string,\n\t\tProvider_Type_Code as string,\n\t\tMENTALHEALTH_AMBULATORY as string,\n\t\tMENTALHEALTH_INPATIENT as string,\n\t\tMENTALHEALTH_DAYNIGHT as string,\n\t\tCHEMDEPEND_AMBULATORY as string,\n\t\tCHEMDEPEND_INPATIENT as string,\n\t\tCHEMDEPEND_DAYNIGHT as string,\n\t\tDRUG_BENEFIT as string,\n\t\tVISION_BENEFIT as string,\n\t\tDENTAL_BENEFIT as string,\n\t\tHospice_Indicator as string,\n\t\tDisease_Management_Program_Indicator as string,\n\t\tDisease_Management_Severity_Factor as string,\n\t\tGROUP_ID as string,\n\t\tOTHER_INSURANCE_FLAG as string,\n\t\tPRIMARY_INSURANCE_FLAG as string,\n\t\tPLANEMPLOYEEFLAG as string,\n\t\tMEDICARE_CONTRACT_NUMBER as string,\n\t\tAID_GROUP as string,\n\t\tCOBRA_FLAG as string,\n\t\tCOVERAGE_TIER as string,\n\t\tEMPLOYERCODE as string,\n\t\tEMPLOYERDESCRIPTION as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE1 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE2 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE3 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE4 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE5 as string,\n\t\tMEMBERENROLLMENTCUSTOMCODE6 as string,\n\t\tMEDICARE_PLANID_NUMBER as string,\n\t\tSNP_ENROLLEE_TYPE as string,\n\t\tPCP_START_DATE as string,\n\t\tPCP_END_DATE as date 'MM/dd/yyyy',\n\t\tClient_Member_Enrollment_ID as string,\n\t\tMember_Enrollment_Member_Alternate_Identifier_1 as string,\n\t\tMember_Enrollment_Alternate_Identifier_2 as string,\n\t\tMember_Enrollment_Alternate_Identifier_3 as string,\n\t\tMember_Enrollment_Alternate_Identifier_4 as string,\n\t\tMember_Enrollment_Alternate_Identifier_5 as string,\n\t\tMember_Enrollment_Alternate_Identifier_6 as string,\n\t\tMember_Enrollment_Alternate_Identifier_7 as string,\n\t\tMember_Enrollment_Alternate_Identifier_8 as string,\n\t\tBenefit_Code as string,\n\t\t{Member Enrollment QHP State} as string,\n\t\tESRD_Flag as string,\n\t\tLTI_Flag as string,\n\t\tIssuer_ID as string,\n\t\tMetal_Level as string,\n\t\tCost_Sharing_Reduction_Code as string,\n\t\tMSP_Flag as string,\n\t\tMarket_Coverage as string,\n\t\tEnrollment_Route as string,\n\t\tCSR_Eligibility_Flag as string,\n\t\tPlan_Marketing_Name as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tinferDriftedColumnTypes: true) ~> source1\nsource(output(\n\t\tMember_Alternate_Identifier as string,\n\t\tMember_id as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> source2\nsource1 keyGenerate(output(Member_Enrollment_ID as long),\n\tstartAt: 1L) ~> SurrogateKey1\nDerivedColumn2, source2 lookup(source1@MEMBER_ID == source2@Member_id,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> Lookup1\nSurrogateKey1 derive(Provider_Type_Code = iif(isNull(PCP_PROVIDERID), PCP_PROVIDERID, 'P3'),\n\t\tPCP_START_DATE = toDate(PCP_START_DATE)) ~> DerivedColumn2\nLookup1 sink(input(\n\t\tMember_Enrollment_ID as integer,\n\t\tMember_KEY as string,\n\t\tClient_Member_ID as string,\n\t\tEnrollment_Contract_ID as integer,\n\t\tEnrollment_Benefit_Plan_ID as integer,\n\t\tCoverage_Begin as date,\n\t\tCoverage_End as date,\n\t\tMEDICAL_BENEFIT_Flag as string,\n\t\tPayer_Code as string,\n\t\tProduct_Code as string,\n\t\tClient_Provider_ID as string,\n\t\tProvider_Type_Code as string,\n\t\tMental_Health_Ambulatory_Indicator as string,\n\t\tMental_Health_Inpatient_Indicator as string,\n\t\tMental_Health_24Hour_Indicator as string,\n\t\tChemical_Dependency_Ambulatory_Indicator as string,\n\t\tChemical_Dependency_Inpatient_Indicator as string,\n\t\tChemical_Dependency_24Hour_Indicator as string,\n\t\tPrescription_Drug_Indicator as string,\n\t\tVision_Indicator as string,\n\t\tDental_Indicator as string,\n\t\tHospice_Indicator as string,\n\t\tDisease_Management_Program_Indicator as string,\n\t\tDisease_Management_Severity_Factor as decimal(18,0),\n\t\tmember_group_code as string,\n\t\tOTHER_INSURANCE_FLAG as string,\n\t\tPRIMARY_INSURANCE_FLAG as string,\n\t\tPlan_Employee_Indicator as string,\n\t\tmedicare_contract_code as string,\n\t\tAID_GROUP as string,\n\t\tCOBRA_FLAG as string,\n\t\tCOVERAGE_TIER as string,\n\t\tEMPLOYERCODE as string,\n\t\tEMPLOYERDESCRIPTION as string,\n\t\tMember_enrollment_CustomCode_1 as string,\n\t\tMember_enrollment_CustomCode_2 as string,\n\t\tMember_enrollment_CustomCode_3 as string,\n\t\tMember_Enrollment_CustomCode_4 as string,\n\t\tMember_Enrollment_CustomCode_5 as string,\n\t\tMember_Enrollment_CustomCode_6 as string,\n\t\tplan_code as string,\n\t\tSNP_ENROLLEE_TYPE as string,\n\t\tPCP_START_DATE as date,\n\t\tPCP_END_DATE as date,\n\t\tClient_Member_Enrollment_ID as string,\n\t\tMember_Enrollment_Member_Alternate_Identifier_1 as string,\n\t\tMember_Enrollment_Alternate_Identifier_2 as string,\n\t\tMember_Enrollment_Alternate_Identifier_3 as string,\n\t\tMember_Enrollment_Alternate_Identifier_4 as string,\n\t\tMember_Enrollment_Alternate_Identifier_5 as string,\n\t\tMember_Enrollment_Alternate_Identifier_6 as string,\n\t\tMember_Enrollment_Alternate_Identifier_7 as string,\n\t\tMember_Enrollment_Alternate_Identifier_8 as string,\n\t\tBenefit_Code as string,\n\t\tMember_Enrollment_QHP_State as string,\n\t\tESRD_Flag as string,\n\t\tLTI_Flag as string,\n\t\tIssuer_ID as string,\n\t\tMetal_Level as string,\n\t\tCost_Sharing_Reduction_Code as string,\n\t\tMSPF_lag as string,\n\t\tMarket_Coverage as string,\n\t\tEnrollment_Route as string,\n\t\tCSR_Eligibility_Flag as string,\n\t\tPlan_Marketing_Name as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tMember_Enrollment_ID,\n\t\tMember_KEY = Member_Alternate_Identifier,\n\t\tClient_Member_ID,\n\t\tEnrollment_Contract_ID,\n\t\tEnrollment_Benefit_Plan_ID,\n\t\tCoverage_Begin = START_DATE,\n\t\tCoverage_End = END_DATE,\n\t\tMEDICAL_BENEFIT_Flag = MEDICAL_BENEFIT,\n\t\tPayer_Code = PAYER_CODE,\n\t\tProduct_Code = PRODUCT_CODE,\n\t\tClient_Provider_ID = PCP_PROVIDERID,\n\t\tProvider_Type_Code,\n\t\tMental_Health_Ambulatory_Indicator = MENTALHEALTH_AMBULATORY,\n\t\tMental_Health_Inpatient_Indicator = MENTALHEALTH_INPATIENT,\n\t\tMental_Health_24Hour_Indicator = MENTALHEALTH_DAYNIGHT,\n\t\tChemical_Dependency_Ambulatory_Indicator = CHEMDEPEND_AMBULATORY,\n\t\tChemical_Dependency_Inpatient_Indicator = CHEMDEPEND_INPATIENT,\n\t\tChemical_Dependency_24Hour_Indicator = CHEMDEPEND_DAYNIGHT,\n\t\tPrescription_Drug_Indicator = DRUG_BENEFIT,\n\t\tVision_Indicator = VISION_BENEFIT,\n\t\tDental_Indicator = DENTAL_BENEFIT,\n\t\tHospice_Indicator,\n\t\tDisease_Management_Program_Indicator,\n\t\tDisease_Management_Severity_Factor,\n\t\tmember_group_code = GROUP_ID,\n\t\tOTHER_INSURANCE_FLAG,\n\t\tPRIMARY_INSURANCE_FLAG,\n\t\tPlan_Employee_Indicator = PLANEMPLOYEEFLAG,\n\t\tmedicare_contract_code = MEDICARE_CONTRACT_NUMBER,\n\t\tAID_GROUP,\n\t\tCOBRA_FLAG,\n\t\tCOVERAGE_TIER,\n\t\tEMPLOYERCODE,\n\t\tEMPLOYERDESCRIPTION,\n\t\tMember_enrollment_CustomCode_1 = MEMBERENROLLMENTCUSTOMCODE1,\n\t\tMember_enrollment_CustomCode_2 = MEMBERENROLLMENTCUSTOMCODE2,\n\t\tMember_enrollment_CustomCode_3 = MEMBERENROLLMENTCUSTOMCODE3,\n\t\tMember_Enrollment_CustomCode_4 = MEMBERENROLLMENTCUSTOMCODE4,\n\t\tMember_Enrollment_CustomCode_5 = MEMBERENROLLMENTCUSTOMCODE5,\n\t\tMember_Enrollment_CustomCode_6 = MEMBERENROLLMENTCUSTOMCODE6,\n\t\tplan_code = MEDICARE_PLANID_NUMBER,\n\t\tSNP_ENROLLEE_TYPE,\n\t\tPCP_START_DATE,\n\t\tPCP_END_DATE,\n\t\tClient_Member_Enrollment_ID,\n\t\tMember_Enrollment_Member_Alternate_Identifier_1,\n\t\tMember_Enrollment_Alternate_Identifier_2,\n\t\tMember_Enrollment_Alternate_Identifier_3,\n\t\tMember_Enrollment_Alternate_Identifier_4,\n\t\tMember_Enrollment_Alternate_Identifier_5,\n\t\tMember_Enrollment_Alternate_Identifier_6,\n\t\tMember_Enrollment_Alternate_Identifier_7,\n\t\tMember_Enrollment_Alternate_Identifier_8,\n\t\tBenefit_Code,\n\t\tMember_Enrollment_QHP_State = {Member Enrollment QHP State},\n\t\tESRD_Flag,\n\t\tLTI_Flag,\n\t\tIssuer_ID,\n\t\tMetal_Level,\n\t\tCost_Sharing_Reduction_Code,\n\t\tMSPF_lag = MSP_Flag,\n\t\tMarket_Coverage,\n\t\tEnrollment_Route,\n\t\tCSR_Eligibility_Flag,\n\t\tPlan_Marketing_Name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}